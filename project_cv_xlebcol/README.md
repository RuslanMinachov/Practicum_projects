# Определение возраста покупателей

## Описание проекта

Сетевой супермаркет «Хлеб-Соль» внедряет систему компьютерного зрения для анализа фотографий покупателей в прикассовой зоне. Цель проекта — разработка модели машинного обучения, которая определяет приблизительный возраст человека по фотографии. Это позволит:
- Анализировать покупательские предпочтения по возрастным группам.
- Контролировать соблюдение правил продажи алкоголя.

## Задачи проекта

1. Провести исследовательский анализ набора фотографий для выявления особенностей данных.
2. Обучить нейронную сеть для определения возраста по фотографиям.
3. Оценить качество модели и подготовить рекомендации для её применения.

## Исходные данные

- Набор фотографий людей с указанием их возраста.
- Данные включают изображения лиц и соответствующие метки возраста (числовые значения).
- Фотографии различаются по качеству, освещению, углу съемки и другим параметрам.

## Результаты работы

### Общие результаты
- Разработана модель для определения возраста по фотографиям для сети «Хлеб-Соль».
- Подготовлены данные:
  - 6073 изображения для обучения.
  - 1518 изображений для валидации.
  - Размер изображений: 224x224, выполнена нормализация.

### Результаты модели
- **Архитектура**: ResNet50 с добавлением слоев GlobalAveragePooling2D и Dense (ReLU).
- **Обучение**: 20 эпох, оптимизатор Adam, метрика MAE (средняя абсолютная ошибка).
- **Итоговые метрики**:
  - Тренировочное MAE: 2.48.
  - Валидационное MAE: 7.55.
- **Нестабильность**: Значение val_loss варьируется от 86.94 до 692.53, val_mae — от 7.22 до 21.20, что указывает на ограниченную обобщающую способность модели.

### Выявленные проблемы
- **Несбалансированность данных**: Пик распределения возрастов в диапазоне 20–30 лет, недостаток данных для возрастов <10 и >60 лет.
- **Условия съемки**: Наличие черно-белых фотографий, поворотов с черными рамками, головных уборов, очков и объектов перед лицом.
- **Отсутствие предобработки**: Усиливает влияние шумов и вариаций, снижая точность предсказаний.

## Рекомендации
1. Собрать новые данные после внедрения модели, используя фотографии с касс и возраст из данных скидочных карт для обучения на реалистичных данных.
2. Добавить больше фотографий подростков и молодежи (14–25 лет) для повышения эффективности контроля продаж алкоголя.
3. Обеспечить разнообразие условий освещения для повышения устойчивости модели.
4. Собрать сбалансированный набор данных для улучшения точности и надежности.

## Итог
Модель пригодна для базового применения, но требует доработки. Улучшение качества и разнообразия данных повысит её эффективность для анализа покупательских предпочтений и контроля продаж алкоголя.
