
# Сервис по определению рыночной стоимости автомобилей

## Описание проекта

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов, в котором можно определить рыночную стоимость автомобиля на основе его технических характеристик, комплектации и цен других автомобилей. Цель проекта — разработать модель машинного обучения, обеспечивающую высокое качество предсказания (RMSE < 2500), с учетом времени обучения и предсказания.

## Задачи проекта

1. Загрузить и изучить данные из файла `/datasets/autos.csv`.
2. Провести предобработку данных: заполнить пропуски, обработать аномалии, удалить неинформативные признаки.
3. Подготовить выборки для обучения моделей.
4. Обучить различные модели, включая LightGBM и как минимум одну модель, не основанную на градиентном бустинге, с подбором гиперпараметров.
5. Оценить модели по критериям: качество предсказания (RMSE), время обучения и время предсказания.
6. Выбрать лучшую модель и проверить её качество на тестовой выборке.

## Исходные данные

- Данные находятся в файле `/datasets/autos.csv`.
- **Целевой признак**:
  - `Price` — цена автомобиля (евро).

## Используемые библиотеки

pandas, numpy, matplotlib, seaborn, phik, lightgbm, catboost, sklearn, optuna

## Результаты работы

### Общие результаты
- Данные загружены из файла `/datasets/autos.csv`, проведена предобработка: обработаны пропуски, аномалии и неинформативные признаки.
- Выполнен корреляционный анализ для определения значимых признаков.
- Данные разделены на обучающую и тестовую выборки для оценки моделей.

### Анализ моделей
1. **DecisionTreeRegressor (с OptunaSearchCV)**:
   - Время обучения: 2 мин 35 с.
   - Время предсказания: 27 мс.
   - RMSE (Train): 2349.87 (кросс-валидация).
   - Комментарий: Длительное время обучения из-за оптимизации гиперпараметров (20 итераций), высокий RMSE, но быстрое предсказание.
2. **CatBoostRegressor**:
   - Время обучения: 3 мин 34 с.
   - Время предсказания: 929 мс.
   - RMSE (Train): 1795.65.
   - Комментарий: Улучшенное качество предсказания по сравнению с DecisionTree, но более длительное время предсказания.
3. **LightGBMRegressor**:
   - Время обучения: 8.55 с.
   - Время предсказания: 1.61 с.
   - RMSE (Train): 1695.96.
   - RMSE (Test): 1763.80.
   - Комментарий: Лучшее качество предсказания и минимальное время обучения, время предсказания приемлемо.

### Выбор лучшей модели
- **Качество предсказания**: LightGBM демонстрирует лучший RMSE (1695.96 на тренировке, 1763.80 на тесте), CatBoost близок (1795.65), DecisionTree уступает (2349.87).
- **Время обучения**: LightGBM лидирует (8.55 с), CatBoost (3 мин 34 с) и DecisionTree (2 мин 35 с) требуют больше времени.
- **Время предсказания**: DecisionTree быстрее всех (27 мс), LightGBM (1.61 с) и CatBoost (929 мс) медленнее, но в допустимых пределах.
- **Вывод**: LightGBMRegressor выбрана как лучшая модель благодаря наименьшему RMSE (1763.80 < 2500) и быстрому обучению, несмотря на чуть более длительное время предсказания.

### Проверка на тестовой выборке
- Качество LightGBM на тестовой выборке: RMSE = 1763.80.
- Минимальная разница между тренировочным (1695.96) и тестовым (1763.80) RMSE указывает на отсутствие значительного переобучения.

## Итоговые выводы и рекомендации
- Модель `LightGBMRegressor` успешно решает задачу определения рыночной стоимости автомобилей, обеспечивая RMSE = 1763.80 (< 2500), быстрое обучение (8.55 с) и приемлемое время предсказания (1.61 с).
- Модель подходит для внедрения в приложение сервиса «Не бит, не крашен» благодаря высокому качеству предсказания и сбалансированным временным характеристикам.
- **Рекомендации**:
  - Периодически обновлять модель с учетом новых данных о продажах автомобилей.
  - Рассмотреть добавление новых признаков (например, региональные особенности или состояние рынка) для повышения точности.
  - Оптимизировать процесс предсказания, если требуется дальнейшее снижение времени предсказания для реального времени.
