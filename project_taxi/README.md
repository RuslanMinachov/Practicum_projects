
# Прогнозирование количества заказов такси на следующий час

## Описание проекта

Компания «Чётенькое такси» стремится оптимизировать привлечение водителей в периоды пиковой нагрузки в аэропортах. Для этого требуется спрогнозировать количество заказов такси на следующий час на основе исторических данных. Цель проекта — разработать модель машинного обучения с метрикой RMSE на тестовой выборке не более 48.

## Задачи проекта

1. Загрузить и изучить данные из файла `taxi.csv`.
2. Выполнить ресемплирование данных по одному часу.
3. Провести исследовательский анализ данных для выявления временных закономерностей.
4. Обучить различные модели с разными гиперпараметрами, используя тестовую выборку размером 10% от исходных данных.
5. Проверить качество моделей на тестовой выборке и сделать выводы.

## Исходные данные

- Данные находятся в файле `/datasets/taxi.csv`.
- **Столбец `num_orders`**: количество заказов такси (числовой показатель).

## Используемые библиотеки

pandas, numpy, matplotlib, seaborn, phik, statsmodels, catboost, lightgbm, optuna, sklearn

## Результаты работы

### Общие результаты
- Данные загружены из файла `taxi.csv` (26496 записей), индекс настроен как временной ряд, пропуски отсутствуют.
- Выполнено ресемплирование данных до почасового интервала, подтверждена монотонность индекса, тип столбца `num_orders` оптимизирован до `int32`.
- Разработана функция `make_features` для создания временных признаков (месяц, день, день недели, час), лагов и скользящего среднего.

### Исследовательский анализ данных
- **Тренд**: Увеличение заказов к лету (с ~1000 в марте до ~3000 в августе 2018 года), связанное с сезонным ростом туристической активности.
- **Суточная сезонность**: Заказы снижаются ночью, нарастают в течение дня и достигают пика к полуночи, что соответствует расписанию авиарейсов.
- **Недельная сезонность**: Выявлены пики в начале и конце выходных, вероятно, связанные с графиком рейсов и поведением пассажиров.
- **Шумы**: Значительный рост шума и амплитуды остатков в августе 2018 года, возможно, из-за праздников, массовых событий или изменений в расписании рейсов.

### Обучение моделей
- Протестированы модели: `LinearRegression`, `Ridge`, `DecisionTreeRegressor`, `LightGBM`, `CatBoost`.
- Гиперпараметры оптимизированы с использованием `Optuna`, кросс-валидация выполнена через `TimeSeriesSplit`.
- **Лучшая модель**: `Ridge` с параметрами `alpha=9.843`, `fit_intercept=False`.
  - RMSE на кросс-валидации: 23.423.
  - RMSE на тестовой выборке (10% данных): 35.933.
- **Причина увеличения RMSE**: Шумы в данных, особенно в августе, повлияли на качество предсказаний на тестовой выборке.

## Итоговые выводы и рекомендации
- Разработанная модель `Ridge` успешно решает задачу прогнозирования количества заказов такси, демонстрируя RMSE = 35.933 на тестовой выборке, что удовлетворяет целевому порогу RMSE ≤ 48.
- Увеличение RMSE на тестовой выборке связано с шумами в данных, выявленными на этапе анализа (особенно в августе 2018 года).
- **Рекомендации**:
  - Собрать дополнительные данные для учета аномалий (праздники, массовые события, изменения расписания рейсов).
  - Добавить внешние признаки, такие как погода, праздничные дни или расписание рейсов, для повышения точности.
  - Периодически переобучать модель на новых данных для адаптации к изменениям в поведении пассажиров.
- Модель готова к внедрению для прогнозирования пиковой нагрузки и оптимизации распределения водителей.
