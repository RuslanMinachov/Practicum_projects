
# Выбор локации для скважины

## Описание проекта

Добывающая компания «ГлавРосГосНефть» ставит задачу определить оптимальный регион для бурения новой скважины. Проект направлен на построение модели машинного обучения для предсказания объёма запасов нефти в скважинах и выбор региона с максимальной суммарной прибылью при минимальных рисках. Основные шаги включают анализ данных геологоразведки, обучение моделей, оценку прибыли и анализ рисков.

## Цель проекта

- Построить модель для определения региона, обеспечивающего наибольшую прибыль от добычи.
- Проанализировать возможную прибыль и риски.

## Задачи проекта

1. Загрузить и изучить данные геологоразведки из файлов `/datasets/geo_data_0.csv`, `/datasets/geo_data_1.csv`, `/datasets/geo_data_2.csv`.
2. Провести предобработку данных: привести к нужным типам, проверить на дубликаты.
3. Выполнить исследовательский анализ данных для выявления особенностей каждого региона.
4. Провести корреляционный анализ признаков.
5. Обучить модели для предсказания объёма запасов.
6. Подготовить данные для расчёта прибыли.
7. Разработать функцию для расчёта прибыли.
8. Оценить прибыль и риски для каждого региона.
9. Сформулировать итоговые выводы и рекомендации.

## Исходные данные

- Данные находятся в файлах:
  - `/datasets/geo_data_0.csv`
  - `/datasets/geo_data_1.csv`
  - `/datasets/geo_data_2.csv`
- **Признаки**:
  - `id` — уникальный идентификатор скважины.
  - `f0`, `f1`, `f2` — три признака точек.
  - `product` — объём запасов в скважине (тыс. баррелей, целевой признак).

## Используемые библиотеки

pandas, matplotlib, seaborn, scipy, sklearn, optuna, numpy, phik

## Результаты работы

### Общие результаты
- Данные загружены из файлов `/datasets/geo_data_0.csv`, `/datasets/geo_data_1.csv`, `/datasets/geo_data_2.csv`. Пропуски отсутствуют, данные приведены к нужным типам.
- Проведена предобработка: проверены дубликаты, подтверждена корректность данных.
- Выполнен исследовательский и корреляционный анализ для каждого региона.

### Анализ регионов
| Показатель                  | Регион 1 (geo_data_0) | Регион 2 (geo_data_1) | Регион 3 (geo_data_2) |
|-----------------------------|-----------------------|-----------------------|-----------------------|
| **Средняя прибыль (млн руб.)** | 407.1                | 445.7                | 567.0                |
| **Дов. интервал (млн руб.)** | [-106.9, 914.8]      | [59.6, 867.3]        | [44.1, 1104.7]       |
| **Ширина интервала (млн руб.)** | 1021.7             | 807.7                | 1060.6               |
| **Риск убытков (%)**        | 5.8                  | 1.1                  | 1.8                  |

- **Регион 1 (geo_data_0)**:
  - Мультимодальное распределение признаков, умеренная корреляция с `product` (0.22–0.48).
  - RMSE: 37.76 (высокая ошибка, низкая точность предсказаний).
  - Наибольший риск убытков (5.8%), не соответствует требованиям проекта.
- **Регион 2 (geo_data_1)**:
  - Высокая корреляция между `f2` и `product` (0.98), низкий RMSE (0.89).
  - Низкий средний запас сырья (68.71 тыс. баррелей), но минимальный риск убытков (1.1%).
  - Наименьшая ширина доверительного интервала (807.7 млн), высокая стабильность.
- **Регион 3 (geo_data_2)**:
  - Мультимодальное распределение `product`, средний запас сырья (94.76 тыс. баррелей) ближе к безубыточному уровню (111.11 тыс. баррелей).
  - Высокий RMSE (38.88), но наибольшая средняя прибыль (567 млн руб.).
  - Риск убытков: 1.8%.

### Выбор региона
- **Рекомендуемый регион**: Регион 2 (geo_data_1).
- **Обоснование**:
  - Минимальный риск убытков (1.1%).
  - Положительный доверительный интервал (59.6–867.3 млн руб.), гарантирующий прибыль.
  - Умеренная средняя прибыль (445.7 млн руб.), выше, чем у Региона 1.
  - Наименьшая ширина доверительного интервала (807.7 млн руб.), что указывает на высокую стабильность.
- Регион 3 имеет более высокую среднюю прибыль (567 млн руб.), но больший риск убытков (1.8%) и шире доверительный интервал.
- Регион 1 наименее привлекателен из-за высокого риска убытков (5.8%).

## Итоговые выводы и рекомендации
- Разработана модель для предсказания объёма запасов нефти, проведён анализ прибыли и рисков для трёх регионов.
- Регион 2 (geo_data_1) рекомендован для разработки скважин благодаря минимальному риску убытков (1.1%), высокой стабильности (узкий доверительный интервал) и умеренной прибыли (445.7 млн руб.).
- **Рекомендации**:
  - Сфокусироваться на бурении скважин в Регионе 2 для минимизации рисков и обеспечения стабильной прибыли.
  - Для Региона 3 рассмотреть дополнительный сбор данных для снижения неопределённости и повышения точности предсказаний.
  - Периодически обновлять модель с учетом новых данных геологоразведки для повышения точности.

