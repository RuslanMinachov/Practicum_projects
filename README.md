# Прогнозирование оттока клиентов оператора связи «ТелеДом»

## Описание проекта

Оператор связи «ТелеДом» стремится снизить уровень оттока клиентов, предлагая промокоды и специальные условия тем, кто планирует разорвать договор. Цель проекта — разработать модель машинного обучения для прогнозирования вероятности оттока клиентов на основе их персональных данных, информации о договорах, тарифах и используемых услугах. Основная задача — создать модель с метрикой ROC-AUC не менее 0.85, чтобы оператор мог своевременно выявлять потенциальных уходящих клиентов и предлагать им удерживающие меры.

### Используемые библиотеки
- **pandas**: для обработки и анализа данных
- **numpy**: для числовых вычислений
- **sklearn**: для построения и оценки моделей машинного обучения
- **catboost**: для реализации градиентного бустинга
- **optuna**: для оптимизации гиперпараметров
- **shap**: для анализа важности признаков
- **matplotlib**, **seaborn**: для визуализации данных

### Задачи проекта
1. Загрузить и изучить данные из файлов `contract_new.csv`, `personal_new.csv`, `internet_new.csv`, `phone_new.csv`.
2. Выполнить предобработку данных: обработать аномалии, преобразовать типы данных, объединить датасеты и создать целевой признак.
3. Провести исследовательский анализ данных (EDA) для выявления закономерностей и ключевых признаков, влияющих на отток.
4. Подготовить данные для моделирования: провести корреляционный анализ, создать пайплайн для обработки признаков.
5. Обучить и оценить модели машинного обучения, выбрав лучшую по метрике ROC-AUC (≥ 0.85).
6. Проанализировать важность признаков для интерпретации модели.
7. Сформулировать рекомендации для бизнеса на основе результатов модели.

### Исходные данные
Данные предоставлены в четырёх файлах, содержащих информацию о клиентах оператора связи «ТелеДом» по состоянию на 1 февраля 2020 года:

- **contract_new.csv** — информация о договоре.
- **personal_new.csv** — персональные данные клиента.
- **internet_new.csv** — информация об интернет-услугах.
- **phone_new.csv** — информация об услугах телефонии.
Все датасеты связаны через столбец `customerID`.

## Выводы
Лучшей моделью для прогнозирования оттока клиентов оказалась **CatBoostClassifier** с метрикой ROC-AUC 0.8727 на кросс-валидации и 0.8784 на тестовой выборке (точность 0.8925). Гиперпараметры оптимизировались с использованием Optuna . Модель эффективно улавливает нелинейные зависимости и превосходит базовые модели, такие как логистическая регрессия (ROC-AUC 0.7676) и дерево решений (ROC-AUC 0.7941).

### Анализ важности признаков
С помощью SHAP были выявлены ключевые факторы, влияющие на отток:
- **contract_duration**: Длительность контракта. Чем дольше клиент остается, тем ниже вероятность расторжения.
- **type**: Тип оплаты. Контракты "Month-to-month" снижают риск оттока, в то время как "Two year" его увеличивают.
- **monthly_charges** и **total_charges**: Высокие месячные и общие расходы клиента негативно влияют на лояльность.

### Рекомендации для бизнеса
1. **Удержание клиентов с короткими контрактами**: Предложить бонусы или скидки для перехода на "Month-to-month" с длинных тарифов.
2. **Поддержка клиентов с высокими расходами**: Усилить работу с клиентами, платящими больше, через качественное обслуживание и персонализированные предложения.
3. **Анализ платежных методов**: Исследовать влияние `payment_method` на отток и адаптировать маркетинговые стратегии.
4. **Фокус на лояльности**: Развивать программы для клиентов с длительным сроком сотрудничества, поддерживая высокий уровень сервиса.

Эти меры помогут снизить отток клиентов и повысить прибыль компании.
